/// <reference path="./all.d.ts" />
var nervous_array_1 = require('nervous-array');
var nervous_sigmoid_1 = require('nervous-sigmoid');
var layer_1 = require('./layer');
var cost_1 = require('./cost');
require('./polyfills/assign');
var NeuralNetwork = (function () {
    function NeuralNetwork(config) {
        this.config = config;
        this.config.hiddenLayers = this.config.hiddenLayers || [this.config.inputLayerSize];
        this.config.trainingOptions = this.config.trainingOptions || {};
        this.config.trainingOptions.iterations = this.config.trainingOptions.iterations || 10000;
        this.config.trainingOptions.batchSize = this.config.trainingOptions.batchSize || 10;
        this.config.trainingOptions.regularization = (this.config.trainingOptions.regularization === undefined) ? 0.0001 : this.config.trainingOptions.regularization;
        this.config.trainingOptions.learningRate = (this.config.trainingOptions.learningRate === undefined) ? 0.5 : this.config.trainingOptions.learningRate;
        this.activationFunctions = {
            activation: nervous_sigmoid_1.sigmoid,
            activationPrime: nervous_sigmoid_1.sigmoidPrime
        };
        switch (this.config.costStrategy) {
            case cost_1.ECostStrategy.Quadratic:
            default:
                this.costStrategy = new cost_1.QuadraticCost(this.activationFunctions);
                break;
            case cost_1.ECostStrategy.CrossEntropy:
                this.costStrategy = new cost_1.CrossEntropyCost(this.activationFunctions);
                break;
        }
        this.neuronsLayers = [];
        this.synapsesLayers = [];
        this.numberOfSynapses = 0;
        //layers creation
        this.neuronsLayers.push(this.inputLayer = new layer_1.InputLayer(config.inputLayerSize));
        for (var i = 0; i < config.hiddenLayers.length; i++) {
            this.neuronsLayers.push(new layer_1.HiddenLayer(config.hiddenLayers[i]));
        }
        this.neuronsLayers.push(this.outputLayer = new layer_1.OutputLayer(config.outputLayerSize));
        //synapses creation
        for (var j = 0; j < this.neuronsLayers.length - 1; j++) {
            var synapses = this.neuronsLayers[j].linkTo(this.neuronsLayers[j + 1]);
            this.synapsesLayers.push(synapses);
            this.numberOfSynapses += synapses.length;
        }
    }
    Object.defineProperty(NeuralNetwork.prototype, "weights", {
        get: function () {
            var weights = [];
            this.forEachSynapse(function (s) {
                weights.push(s.weight);
            });
            return weights;
        },
        set: function (synapses) {
            if (synapses.length !== this.numberOfSynapses) {
                throw new Error("The number of synapses differs.");
            }
            var cpt = 0;
            this.forEachSynapse(function (s) {
                s.weight = synapses[cpt++];
            });
        },
        enumerable: true,
        configurable: true
    });
    NeuralNetwork.prototype.getGradients = function (data) {
        var gradients = [];
        this.backward(data);
        this.forEachSynapse(function (s) {
            gradients.push(s.gradient);
        });
        return gradients;
    };
    NeuralNetwork.prototype.forEachSynapse = function (func) {
        for (var i = 0; i < this.synapsesLayers.length; i++) {
            for (var j = 0; j < this.synapsesLayers[i].length; j++) {
                func(this.synapsesLayers[i][j], i, j);
            }
        }
    };
    NeuralNetwork.prototype.forward = function (data) {
        var ret = [];
        for (var k = 0; k < data.length; k++) {
            //set input to input layer neurons
            this.inputLayer.neuronsValue = data[k].input;
            //propagate on each hidden layer and output
            for (var i = 1; i < this.neuronsLayers.length; i++) {
                this.neuronsLayers[i].activate(this.activationFunctions);
            }
            //retrieve output neuron value
            ret.push(this.outputLayer.neuronsValue);
        }
        return ret;
    };
    NeuralNetwork.prototype.cost = function (data) {
        var yHats = this.forward(data), j = 0, weightsSum = 0;
        for (var k = 0; k < data.length; k++) {
            j += this.costStrategy.fn(data[k].output, yHats[k]);
        }
        j = j / data.length;
        this.forEachSynapse(function (s) {
            weightsSum += Math.pow(s.weight, 2);
        });
        j += this.config.trainingOptions.regularization / (2 * data.length) * weightsSum;
        return j;
    };
    NeuralNetwork.prototype.backward = function (data) {
        var ret = [];
        for (var k = 0; k < data.length; k++) {
            var tuple = data[k], yHat = this.forward([tuple])[0];
            //set the input and output layer value
            this.inputLayer.neuronsValue = tuple.input;
            this.outputLayer.neuronsValue = nervous_array_1.sub(yHat, tuple.output);
            //compute propagation errors for all layers expect input
            for (var i = this.neuronsLayers.length - 1; i >= 1; i--) {
                this.neuronsLayers[i].computeErrors(this.costStrategy);
            }
            //compute dJdW for all synapses layer
            for (var i = 0; i < this.neuronsLayers.length; i++) {
                this.neuronsLayers[i].computeGradients();
            }
        }
        return this.synapsesLayers;
    };
    NeuralNetwork.prototype.adjustWeigths = function (synapses, batchSize, dataSize) {
        var _this = this;
        if (synapses.length !== this.synapsesLayers.length) {
            throw new Error("The number of synapses layers differs.");
        }
        for (var i = 0; i < synapses.length; i++) {
            if (synapses[i].length !== this.synapsesLayers[i].length) {
                throw new Error("The number of synapses in the " + i + " layer differs");
            }
        }
        this.forEachSynapse(function (s) {
            s.weight = (1 - _this.config.trainingOptions.learningRate * _this.config.trainingOptions.regularization / dataSize) * s.weight - _this.config.trainingOptions.learningRate / batchSize * s.gradient;
            s.gradient = 0;
        });
    };
    NeuralNetwork.prototype.train = function (data, options) {
        Object.assign(this.config.trainingOptions, options);
        var iterations = this.config.trainingOptions.iterations, batchSize = this.config.trainingOptions.batchSize = (this.config.trainingOptions.batchSize > data.length) ? data.length : this.config.trainingOptions.batchSize;
        for (var i = 0; i < iterations; i++) {
            if (batchSize && batchSize !== data.length) {
                nervous_array_1.shuffle(data);
            }
            var batch = data.slice(0, batchSize), synapses = this.backward(batch);
            this.adjustWeigths(synapses, batchSize, data.length);
            if (this.config.trainingOptions.log && (i % (iterations / 100) === 0)) {
                console.info("Progress " + i / iterations + ", cost: " + this.cost(data));
            }
        }
        return {
            error: this.cost(data)
        };
    };
    return NeuralNetwork;
})();
exports.NeuralNetwork = NeuralNetwork;
function computeNumericalGradients(n, data) {
    var epsilon = 1e-4, initialWeights = n.weights, numGrads = initialWeights.length, gradients = nervous_array_1.zeros(numGrads), perturb = nervous_array_1.zeros(numGrads), k;
    for (k = 0; k < numGrads; k++) {
        var loss1 = void 0, loss2 = void 0;
        perturb[k] = epsilon;
        n.weights = nervous_array_1.add(initialWeights, perturb);
        loss2 = n.cost(data);
        n.weights = nervous_array_1.sub(initialWeights, perturb);
        loss1 = n.cost(data);
        gradients[k] = nervous_array_1.sum(nervous_array_1.multiplyByScalar(nervous_array_1.sub(loss2, loss1), 1 / (epsilon * 2)));
        perturb[k] = 0;
    }
    n.weights = initialWeights;
    return gradients;
}
exports.computeNumericalGradients = computeNumericalGradients;
// let n = new NeuralNetwork({
//   inputLayerSize: 2,
//   hiddenLayers: [3],
//   outputLayerSize: 1,
//   trainingOptions: {
//     regularization: 0.0001,
//     iterations: 1000000,
//     learningRate: 1,
//     log: true
//   }
// });
// console.log('----- Neural Network -----');
// console.log(n);
// let data: ITrainingData = [
//   {
//     input: [3.0 / 10.0, 5.0 / 10.0],
//     output: [75.0 / 100.0]
//   },
//   {
//     input: [5.0 / 10.0, 1.0 / 10.0],
//     output: [82.0 / 100.0]
//   },
//   {
//     input: [10.0 / 10.0, 2.0 / 10.0],
//     output: [93.0 / 100.0]
//   },
//   {
//     input: [6.0 / 10.0, 3.0 / 10.0],
//     output: [81.0 / 100.0]
//   }
// ];
// let gradients = n.getGradients(data),
//     numGradients = computeNumericalGradients(n, data);
// //biases neurons regulation
// numGradients.forEach((x, i) => {
//   if (x === 0) {
//     numGradients[i] = gradients[i];
//   }
// });
// let normResult = rootMeanSquare(sub(gradients, numGradients)) / rootMeanSquare(add(gradients, numGradients));
// console.log('----- Gradient comparaison -----');
// console.info(normResult);
// console.info('----- PRE TRAINING -----');
// console.log(n.forward(data));
// console.log(n.cost(data));
// let time = +new Date();
// n.train(data);
// console.log(+new Date() - time, 'ms');
// console.info('----- POST TRAINING -----');
// console.log(n.forward(data));
// console.log(n.cost(data));

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5ldXJhbC1uZXR3b3JrLnRzIl0sIm5hbWVzIjpbIk5ldXJhbE5ldHdvcmsiLCJOZXVyYWxOZXR3b3JrLmNvbnN0cnVjdG9yIiwiTmV1cmFsTmV0d29yay53ZWlnaHRzIiwiTmV1cmFsTmV0d29yay5nZXRHcmFkaWVudHMiLCJOZXVyYWxOZXR3b3JrLmZvckVhY2hTeW5hcHNlIiwiTmV1cmFsTmV0d29yay5mb3J3YXJkIiwiTmV1cmFsTmV0d29yay5jb3N0IiwiTmV1cmFsTmV0d29yay5iYWNrd2FyZCIsIk5ldXJhbE5ldHdvcmsuYWRqdXN0V2VpZ3RocyIsIk5ldXJhbE5ldHdvcmsudHJhaW4iLCJjb21wdXRlTnVtZXJpY2FsR3JhZGllbnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxtQ0FBbUM7QUFFbkMsOEJBQXlGLGVBQWUsQ0FBQyxDQUFBO0FBQ3pHLGdDQUFvQyxpQkFBaUIsQ0FBQyxDQUFBO0FBRXRELHNCQUEwRCxTQUFTLENBQUMsQ0FBQTtBQUVwRSxxQkFBMkUsUUFBUSxDQUFDLENBQUE7QUFFcEYsUUFBTyxvQkFBb0IsQ0FBQyxDQUFBO0FBZ0M1QjtJQVdFQSx1QkFDVUEsTUFBbUNBO1FBQW5DQyxXQUFNQSxHQUFOQSxNQUFNQSxDQUE2QkE7UUFHM0NBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLFlBQVlBLEdBQUdBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLFlBQVlBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLGNBQWNBLENBQUNBLENBQUNBO1FBRXBGQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxlQUFlQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxlQUFlQSxJQUFJQSxFQUFFQSxDQUFDQTtRQUNoRUEsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsVUFBVUEsR0FBR0EsSUFBSUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsZUFBZUEsQ0FBQ0EsVUFBVUEsSUFBSUEsS0FBS0EsQ0FBQ0E7UUFDekZBLElB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QUFlQSxDQUFDQSxTQUFTQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxlQUFlQSxDQUFDQSxTQUFTQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxHQUFHQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxlQUFlQSxDQUFDQSxTQUFTQSxDQUFDQTtRQUVwS0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsRUFBR0EsQ0FBQ0EsR0FBR0EsVUFBVUEsRUFBR0EsQ0FBQ0EsRUFBRUEsRUFBRUEsQ0FBQ0E7WUFFdENBLEVBQUVBLENBQUNBLENBQUNBLFNBQVNBLElBQUlBLFNBQVNBLEtBQUtBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLENBQUNBO2dCQUMzQ0EsdUJBQU9BLENBQUNBLElBQUlBLENBQUNBLENBQUNBO1lBQ2hCQSxDQUFDQTtZQUVEQSxJQUFJQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxFQUFFQSxTQUFTQSxDQUFDQSxFQUNoQ0EsUUFBUUEsR0FBR0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsQ0FBQ0E7WUFFcENBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFFBQVFBLEVBQUVBLFNBQVNBLEVBQUVBLElBQUlBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBO1lBRXJEQSxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxDQUFDQSxlQUFlQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxVQUFVQSxHQUFDQSxHQUFHQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFDcEVBLE9BQU9BLENBQUNBLElBQUlBLENBQUNBLGNBQVlBLENBQUNBLEdBQUdBLFVBQVVBLGdCQUFXQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFHQSxD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QUUxQixpQkFBaUI7QUFFakIseUNBQXlDO0FBRXpDLDZDQUE2QztBQUM3QyxnQ0FBZ0M7QUFDaEMsNkJBQTZCIiwiZmlsZSI6Im5ldXJhbC1uZXR3b3JrLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4vYWxsLmQudHNcIiAvPlxuXG5pbXBvcnQge2FkZCwgc3ViLCBtdWx0aXBseUJ5U2NhbGFyLCBhZGRTY2FsYXIsIHN1bSwgemVyb3MsIHNodWZmbGUsIHJvb3RNZWFuU3F1YXJlfSBmcm9tICduZXJ2b3VzLWFycmF5JztcbmltcG9ydCB7c2lnbW9pZCwgc2lnbW9pZFByaW1lfSBmcm9tICduZXJ2b3VzLXNpZ21vaWQnO1xuXG5pbXBvcnQge0xheWVyLCBJbnB1dExheWVyLCBIaWRkZW5MYXllciwgT3V0cHV0TGF5ZXJ9IGZyb20gJy4vbGF5ZXInO1xuaW1wb3J0IHtTeW5hcHNlLCBJU3luYXBzZXNMYXllcn0gZnJvbSAnLi9zeW5hcHNlJztcbmltcG9ydCB7Q29zdFN0cmF0ZWd5LCBFQ29zdFN0cmF0ZWd5LCBRdWFkcmF0aWNDb3N0LCBDcm9zc0VudHJvcHlDb3N0fSBmcm9tICcuL2Nvc3QnO1xuXG5pbXBvcnQgJy4vcG9seWZpbGxzL2Fzc2lnbic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgSUFjdGl2YXRpb25GdW5jdGlvbnMge1xuICBhY3RpdmF0aW9uOiAoejogbnVtYmVyKSA9PiBudW1iZXI7XG4gIGFjdGl2YXRpb25QcmltZTogKHo6IG51bWJlcikgPT4gbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElUcmFpbmluZ0NvbmZpZ3VyYXRpb24ge1xuICByZWd1bGFyaXphdGlvbj86IG51bWJlcjtcbiAgYmF0Y2hTaXplPzogbnVtYmVyO1xuICBsZWFybmluZ1JhdGU/OiBudW1iZXI7XG4gIGl0ZXJhdGlvbnM/OiBudW1iZXI7XG4gIGxvZz86IGJvb2xlYW47XG59XG5leHBvcnQgaW50ZXJmYWNlIElOZXVyYWxOZXR3b3JrQ29uZmlndXJhdGlvbiB7XG4gIGlucHV0TGF5ZXJTaXplOiBudW1iZXI7XG4gIGhpZGRlbkxheWVycz86IG51bWJlcltdO1xuICBvdXRwdXRMYXllclNpemU6IG51bWJlcjtcbiAgdHJhaW5pbmdPcHRpb25zPzogSVRyYWluaW5nQ29uZmlndXJhdGlvbjtcbiAgY29zdFN0cmF0ZWd5PzogRUNvc3RTdHJhdGVneTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBJVHVwbGUge1xuICBpbnB1dDogQXJyYXk8bnVtYmVyPjtcbiAgb3V0cHV0PzogQXJyYXk8bnVtYmVyPjsgXG59XG5leHBvcnQgaW50ZXJmYWNlIElUcmFpbmluZ0RhdGEgZXh0ZW5kcyBBcnJheTxJVHVwbGU+IHt9XG5cbmV4cG9ydCBpbnRlcmZhY2UgSVRyYWluaW5nT3V0cHV0IHtcbiAgZXJyb3I6IG51bWJlclxufVxuXG5leHBvcnQgY2xhc3MgTmV1cmFsTmV0d29yayB7XG4gIFxuICBwcml2YXRlIG5ldXJvbnNMYXllcnM6IExheWVyW107XG4gIHByaXZhdGUgc3luYXBzZXNMYXllcnM6IElTeW5hcHNlc0xheWVyW107XG4gIHByaXZhdGUgbnVtYmVyT2ZTeW5hcHNlczogbnVtYmVyO1xuICBwcml2YXRlIGlucHV0TGF5ZXI6IElucHV0TGF5ZXI7XG4gIHByaXZhdGUgb3V0cHV0TGF5ZXI6IE91dHB1dExheWVyO1xuICBcbiAgcHJpdmF0ZSBhY3RpdmF0aW9uRnVuY3Rpb25zOiBJQWN0aXZhdGlvbkZ1bmN0aW9ucztcbiAgcHJpdmF0ZSBjb3N0U3RyYXRlZ3k6IENvc3RTdHJhdGVneTtcblxuICBjb25zdHJ1Y3RvciAoXG4gICAgcHJpdmF0ZSBjb25maWc6IElOZXVyYWxOZXR3b3JrQ29uZmlndXJhdGlvblxuICApIHtcbiAgICBcbiAgICB0aGlzLmNvbmZpZy5oaWRkZW5MYXllcnMgPSB0aGlzLmNvbmZpZy5oaWRkZW5MYXllcnMgfHwgW3RoaXMuY29uZmlnLmlucHV0TGF5ZXJTaXplXTtcbiAgICBcbiAgICB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMgPSB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMgfHwge307XG4gICAgdGhpcy5jb25maWcudHJhaW5pbmdPcHRpb25zLml0ZXJhdGlvbnMgPSB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMuaXRlcmF0aW9ucyB8fCAxMDAwMDtcbiAgICB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMuYmF0Y2hTaXplID0gdGhpcy5jb25maWcudHJhaW5pbmdPcHRpb25zLmJhdGNoU2l6ZSB8fCAxMDtcbiAgICB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMucmVndWxhcml6YXRpb24gPSAodGhpcy5jb25maWcudHJhaW5pbmdPcHRpb25zLnJlZ3VsYXJpemF0aW9uID09PSB1bmRlZmluZWQpID8gMC4wMDAxIDogdGhpcy5jb25maWcudHJhaW5pbmdPcHRpb25zLnJlZ3VsYXJpemF0aW9uO1xuICAgIHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5sZWFybmluZ1JhdGUgPSAodGhpcy5jb25maWcudHJhaW5pbmdPcHRpb25zLmxlYXJuaW5nUmF0ZSA9PT0gdW5kZWZpbmVkKSA/IDAuNSA6IHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5sZWFybmluZ1JhdGU7XG4gICAgXG4gICAgdGhpcy5hY3RpdmF0aW9uRnVuY3Rpb25zID0ge1xuICAgICAgYWN0aXZhdGlvbjogc2lnbW9pZCxcbiAgICAgIGFjdGl2YXRpb25QcmltZTogc2lnbW9pZFByaW1lXG4gICAgfTtcbiAgICBcbiAgICBzd2l0Y2ggKHRoaXMuY29uZmlnLmNvc3RTdHJhdGVneSkge1xuICAgICAgY2FzZSBFQ29zdFN0cmF0ZWd5LlF1YWRyYXRpYzpcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRoaXMuY29zdFN0cmF0ZWd5ID0gbmV3IFF1YWRyYXRpY0Nvc3QodGhpcy5hY3RpdmF0aW9uRnVuY3Rpb25zKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEVDb3N0U3RyYXRlZ3kuQ3Jvc3NFbnRyb3B5OlxuICAgICAgICB0aGlzLmNvc3RTdHJhdGVneSA9IG5ldyBDcm9zc0VudHJvcHlDb3N0KHRoaXMuYWN0aXZhdGlvbkZ1bmN0aW9ucyk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgIFxuICAgIHRoaXMubmV1cm9uc0xheWVycyA9IFtdO1xuICAgIHRoaXMuc3luYXBzZXNMYXllcnMgPSBbXTtcbiAgICB0aGlzLm51bWJlck9mU3luYXBzZXMgPSAwO1xuXG4gICAgLy9sYXllcnMgY3JlYXRpb25cbiAgICB0aGlzLm5ldXJvbnNMYXllcnMucHVzaCh0aGlzLmlucHV0TGF5ZXIgPSBuZXcgSW5wdXRMYXllcihjb25maWcuaW5wdXRMYXllclNpemUpKTtcbiAgICBmb3IgKGxldCBpID0gMCA7IGkgPCBjb25maWcuaGlkZGVuTGF5ZXJzLmxlbmd0aCA7IGkrKykge1xuICAgICAgdGhpcy5uZXVyb25zTGF5ZXJzLnB1c2gobmV3IEhpZGRlbkxheWVyKGNvbmZpZy5oaWRkZW5MYXllcnNbaV0pKTtcbiAgICB9XG4gICAgdGhpcy5uZXVyb25zTGF5ZXJzLnB1c2godGhpcy5vdXRwdXRMYXllciA9IG5ldyBPdXRwdXRMYXllcihjb25maWcub3V0cHV0TGF5ZXJTaXplKSk7XG5cbiAgICAvL3N5bmFwc2VzIGNyZWF0aW9uXG4gICAgZm9yIChsZXQgaiA9IDAgOyBqIDwgdGhpcy5uZXVyb25zTGF5ZXJzLmxlbmd0aCAtIDE7IGorKykge1xuICAgICAgbGV0IHN5bmFwc2VzID0gdGhpcy5uZXVyb25zTGF5ZXJzW2pdLmxpbmtUbyh0aGlzLm5ldXJvbnNMYXllcnNbaiArIDFdKTtcbiAgICAgIHRoaXMuc3luYXBzZXNMYXllcnMucHVzaChzeW5hcHNlcyk7XG4gICAgICB0aGlzLm51bWJlck9mU3luYXBzZXMgKz0gc3luYXBzZXMubGVuZ3RoO1xuICAgIH1cblxuICB9XG5cbiAgZ2V0IHdlaWdodHMgKCk6IG51bWJlcltdIHtcbiAgICBcbiAgICBsZXQgd2VpZ2h0cyA9IFtdO1xuICAgIFxuICAgIHRoaXMuZm9yRWFjaFN5bmFwc2UoKHMpID0+IHtcbiAgICAgIHdlaWdodHMucHVzaChzLndlaWdodCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHdlaWdodHM7XG4gICAgXG4gIH1cbiAgc2V0IHdlaWdodHMgKHN5bmFwc2VzOiBudW1iZXJbXSkge1xuICAgIFxuICAgIGlmIChzeW5hcHNlcy5sZW5ndGggIT09IHRoaXMubnVtYmVyT2ZTeW5hcHNlcykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgbnVtYmVyIG9mIHN5bmFwc2VzIGRpZmZlcnMuYCk7XG4gICAgfVxuICAgIFxuICAgIGxldCBjcHQgPSAwO1xuICAgIFxuICAgIHRoaXMuZm9yRWFjaFN5bmFwc2UoKHMpID0+IHtcbiAgICAgIHMud2VpZ2h0ID0gc3luYXBzZXNbY3B0KytdO1xuICAgIH0pO1xuICAgIFxuICB9XG4gIFxuICBwdWJsaWMgZ2V0R3JhZGllbnRzIChkYXRhOiBJVHJhaW5pbmdEYXRhKTogbnVtYmVyW10ge1xuICAgIFxuICAgIGxldCBncmFkaWVudHMgPSBbXTsgXG4gICAgXG4gICAgdGhpcy5iYWNrd2FyZChkYXRhKTtcbiAgICB0aGlzLmZvckVhY2hTeW5hcHNlKChzKSA9PiB7XG4gICAgICBncmFkaWVudHMucHVzaChzLmdyYWRpZW50KTtcbiAgICB9KTtcbiAgICByZXR1cm4gZ3JhZGllbnRzO1xuICAgIFxuICB9XG4gIFxuICBwdWJsaWMgZm9yRWFjaFN5bmFwc2UgKGZ1bmM6ICh4OiBTeW5hcHNlLCBpbmRleEk/OiBudW1iZXIsIGluZGV4Sj86IG51bWJlcikgPT4gdm9pZCkge1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zeW5hcHNlc0xheWVycy5sZW5ndGggOyBpKyspIHtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5zeW5hcHNlc0xheWVyc1tpXS5sZW5ndGggOyBqKyspIHtcbiAgICAgICAgZnVuYyh0aGlzLnN5bmFwc2VzTGF5ZXJzW2ldW2pdLCBpLCBqKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gIH1cblxuICBwdWJsaWMgZm9yd2FyZCAoZGF0YTogSVRyYWluaW5nRGF0YSk6IG51bWJlcltdW10ge1xuXG4gICAgbGV0IHJldCA9IFtdO1xuXG4gICAgZm9yIChsZXQgayA9IDAgOyBrIDwgZGF0YS5sZW5ndGggOyBrICsrICkge1xuICAgICAgXG4gICAgICAvL3NldCBpbnB1dCB0byBpbnB1dCBsYXllciBuZXVyb25zXG4gICAgICB0aGlzLmlucHV0TGF5ZXIubmV1cm9uc1ZhbHVlID0gZGF0YVtrXS5pbnB1dDtcbiAgICAgIC8vcHJvcGFnYXRlIG9uIGVhY2ggaGlkZGVuIGxheWVyIGFuZCBvdXRwdXRcbiAgICAgIGZvciAobGV0IGkgPSAxIDsgaSA8IHRoaXMubmV1cm9uc0xheWVycy5sZW5ndGggOyBpKyspIHtcbiAgICAgICAgdGhpcy5uZXVyb25zTGF5ZXJzW2ldLmFjdGl2YXRlKHRoaXMuYWN0aXZhdGlvbkZ1bmN0aW9ucyk7XG4gICAgICB9XG4gICAgICAvL3JldHJpZXZlIG91dHB1dCBuZXVyb24gdmFsdWVcbiAgICAgIHJldC5wdXNoKHRoaXMub3V0cHV0TGF5ZXIubmV1cm9uc1ZhbHVlKTtcbiAgICAgIFxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICAgIFxuICB9XG5cbiAgcHVibGljIGNvc3QgKGRhdGE6IElUcmFpbmluZ0RhdGEpOiBudW1iZXIge1xuXG4gICAgbGV0IHlIYXRzID0gdGhpcy5mb3J3YXJkKGRhdGEpLFxuICAgICAgICBqOiBudW1iZXIgPSAwLFxuICAgICAgICB3ZWlnaHRzU3VtID0gMDtcbiAgICBcbiAgICBmb3IgKGxldCBrID0gMDsgayA8IGRhdGEubGVuZ3RoOyBrKyspIHtcbiAgICAgIGogKz0gdGhpcy5jb3N0U3RyYXRlZ3kuZm4oZGF0YVtrXS5vdXRwdXQsIHlIYXRzW2tdKTtcbiAgICB9XG4gICAgXG4gICAgaiA9IGogLyBkYXRhLmxlbmd0aDtcbiAgICBcbiAgICB0aGlzLmZvckVhY2hTeW5hcHNlKChzKSA9PiB7XG4gICAgICB3ZWlnaHRzU3VtICs9IE1hdGgucG93KHMud2VpZ2h0LCAyKTtcbiAgICB9KTtcbiAgICBcbiAgICBqICs9IHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5yZWd1bGFyaXphdGlvbiAvICgyICogZGF0YS5sZW5ndGgpICogd2VpZ2h0c1N1bTtcbiAgICBcbiAgICByZXR1cm4gajtcbiBcbiAgfVxuXG4gIHB1YmxpYyBiYWNrd2FyZCAoZGF0YTogSVRyYWluaW5nRGF0YSk6IElTeW5hcHNlc0xheWVyW10ge1xuXG4gICAgbGV0IHJldCA9IFtdO1xuXG4gICAgZm9yIChsZXQgayA9IDAgOyBrIDwgZGF0YS5sZW5ndGggOyBrICsrICkge1xuICAgICAgXG4gICAgICBsZXQgdHVwbGUgPSBkYXRhW2tdLFxuICAgICAgICAgIHlIYXQgPSB0aGlzLmZvcndhcmQoW3R1cGxlXSlbMF07XG5cbiAgICAgIC8vc2V0IHRoZSBpbnB1dCBhbmQgb3V0cHV0IGxheWVyIHZhbHVlXG4gICAgICB0aGlzLmlucHV0TGF5ZXIubmV1cm9uc1ZhbHVlID0gdHVwbGUuaW5wdXQ7XG4gICAgICB0aGlzLm91dHB1dExheWVyLm5ldXJvbnNWYWx1ZSA9IHN1Yih5SGF0LCB0dXBsZS5vdXRwdXQpO1xuICAgICAgLy9jb21wdXRlIHByb3BhZ2F0aW9uIGVycm9ycyBmb3IgYWxsIGxheWVycyBleHBlY3QgaW5wdXRcbiAgICAgIGZvciAobGV0IGkgPSB0aGlzLm5ldXJvbnNMYXllcnMubGVuZ3RoIC0gMSA7IGkgPj0gMSA7IGktLSkge1xuICAgICAgICB0aGlzLm5ldXJvbnNMYXllcnNbaV0uY29tcHV0ZUVycm9ycyh0aGlzLmNvc3RTdHJhdGVneSk7XG4gICAgICB9XG4gICAgICAvL2NvbXB1dGUgZEpkVyBmb3IgYWxsIHN5bmFwc2VzIGxheWVyXG4gICAgICBmb3IgKGxldCBpID0gMCA7IGkgPCB0aGlzLm5ldXJvbnNMYXllcnMubGVuZ3RoICA7IGkrKykge1xuICAgICAgICB0aGlzLm5ldXJvbnNMYXllcnNbaV0uY29tcHV0ZUdyYWRpZW50cygpO1xuICAgICAgfVxuXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLnN5bmFwc2VzTGF5ZXJzO1xuXG4gIH1cblxuICBwdWJsaWMgYWRqdXN0V2VpZ3RocyAoc3luYXBzZXM6IElTeW5hcHNlc0xheWVyW10sIGJhdGNoU2l6ZTogbnVtYmVyLCBkYXRhU2l6ZTogbnVtYmVyKSB7XG5cbiAgICBpZiAoc3luYXBzZXMubGVuZ3RoICE9PSB0aGlzLnN5bmFwc2VzTGF5ZXJzLmxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgbnVtYmVyIG9mIHN5bmFwc2VzIGxheWVycyBkaWZmZXJzLmApO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN5bmFwc2VzLmxlbmd0aCA7IGkrKykge1xuICAgICAgaWYgKHN5bmFwc2VzW2ldLmxlbmd0aCAhPT0gdGhpcy5zeW5hcHNlc0xheWVyc1tpXS5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgbnVtYmVyIG9mIHN5bmFwc2VzIGluIHRoZSAke2l9IGxheWVyIGRpZmZlcnNgKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhpcy5mb3JFYWNoU3luYXBzZSgocykgPT4ge1xuICAgICAgcy53ZWlnaHQgPSAoMSAtIHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5sZWFybmluZ1JhdGUgKiB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMucmVndWxhcml6YXRpb24gLyBkYXRhU2l6ZSkgKiBzLndlaWdodCAtIHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5sZWFybmluZ1JhdGUgLyBiYXRjaFNpemUgKiBzLmdyYWRpZW50O1xuICAgICAgcy5ncmFkaWVudCA9IDA7XG4gICAgfSk7XG4gICAgXG4gIH1cbiAgXG4gIHB1YmxpYyB0cmFpbiAoZGF0YTogSVRyYWluaW5nRGF0YSwgb3B0aW9ucz86IElUcmFpbmluZ0NvbmZpZ3VyYXRpb24pOiBJVHJhaW5pbmdPdXRwdXQge1xuICAgIFxuICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb25maWcudHJhaW5pbmdPcHRpb25zLCBvcHRpb25zKTtcbiAgICBcbiAgICBsZXQgaXRlcmF0aW9ucyA9IHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5pdGVyYXRpb25zLFxuICAgICAgICBiYXRjaFNpemUgPSB0aGlzLmNvbmZpZy50cmFpbmluZ09wdGlvbnMuYmF0Y2hTaXplID0gKHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5iYXRjaFNpemUgPiBkYXRhLmxlbmd0aCkgPyBkYXRhLmxlbmd0aCA6IHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5iYXRjaFNpemU7XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDAgOyBpIDwgaXRlcmF0aW9ucyA7IGkrKykge1xuICAgICAgXG4gICAgICBpZiAoYmF0Y2hTaXplICYmIGJhdGNoU2l6ZSAhPT0gZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgc2h1ZmZsZShkYXRhKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgbGV0IGJhdGNoID0gZGF0YS5zbGljZSgwLCBiYXRjaFNpemUpLCBcbiAgICAgICAgICBzeW5hcHNlcyA9IHRoaXMuYmFja3dhcmQoYmF0Y2gpO1xuICAgICAgICAgIFxuICAgICAgdGhpcy5hZGp1c3RXZWlndGhzKHN5bmFwc2VzLCBiYXRjaFNpemUsIGRhdGEubGVuZ3RoKTtcbiAgICAgIFxuICAgICAgaWYgKHRoaXMuY29uZmlnLnRyYWluaW5nT3B0aW9ucy5sb2cgJiYgKGkgJSAoaXRlcmF0aW9ucy8xMDApID09PSAwKSkge1xuICAgICAgICBjb25zb2xlLmluZm8oYFByb2dyZXNzICR7aSAvIGl0ZXJhdGlvbnN9LCBjb3N0OiAke3RoaXMuY29zdChkYXRhKX1gKTtcbiAgICAgIH1cbiAgICBcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiB0aGlzLmNvc3QoZGF0YSlcbiAgICB9O1xuICAgIFxuICB9XG4gIFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY29tcHV0ZU51bWVyaWNhbEdyYWRpZW50cyAobjogTmV1cmFsTmV0d29yaywgZGF0YTogSVRyYWluaW5nRGF0YSkge1xuXG4gIGxldCBlcHNpbG9uID0gMWUtNCxcbiAgICAgIGluaXRpYWxXZWlnaHRzOiBudW1iZXJbXSA9IG4ud2VpZ2h0cyxcbiAgICAgIG51bUdyYWRzID0gaW5pdGlhbFdlaWdodHMubGVuZ3RoLFxuICAgICAgZ3JhZGllbnRzOiBudW1iZXJbXSA9IHplcm9zKG51bUdyYWRzKSxcbiAgICAgIHBlcnR1cmI6IEFycmF5PG51bWJlcj4gPSB6ZXJvcyhudW1HcmFkcyksXG4gICAgICBrO1xuICAgIFxuICBmb3IgKGsgPSAwOyBrIDwgbnVtR3JhZHM7IGsrKykge1xuXG4gICAgbGV0IGxvc3MxLCBsb3NzMjtcblxuICAgIHBlcnR1cmJba10gPSBlcHNpbG9uO1xuICAgIG4ud2VpZ2h0cyA9IGFkZChpbml0aWFsV2VpZ2h0cywgcGVydHVyYik7XG4gICAgbG9zczIgPSBuLmNvc3QoZGF0YSk7XG4gICAgbi53ZWlnaHRzID0gc3ViKGluaXRpYWxXZWlnaHRzLCBwZXJ0dXJiKTtcbiAgICBsb3NzMSA9IG4uY29zdChkYXRhKVxuICAgIGdyYWRpZW50c1trXSA9IHN1bShtdWx0aXBseUJ5U2NhbGFyKHN1Yihsb3NzMiwgbG9zczEpLCAxIC8gKGVwc2lsb24gKiAyKSkpO1xuICAgIHBlcnR1cmJba10gPSAwO1xuXG4gIH1cbiAgbi53ZWlnaHRzID0gaW5pdGlhbFdlaWdodHM7XG4gIHJldHVybiBncmFkaWVudHM7XG5cbn1cblxuLy8gbGV0IG4gPSBuZXcgTmV1cmFsTmV0d29yayh7XG4vLyAgIGlucHV0TGF5ZXJTaXplOiAyLFxuLy8gICBoaWRkZW5MYXllcnM6IFszXSxcbi8vICAgb3V0cHV0TGF5ZXJTaXplOiAxLFxuLy8gICB0cmFpbmluZ09wdGlvbnM6IHtcbi8vICAgICByZWd1bGFyaXphdGlvbjogMC4wMDAxLFxuLy8gICAgIGl0ZXJhdGlvbnM6IDEwMDAwMDAsXG4vLyAgICAgbGVhcm5pbmdSYXRlOiAxLFxuLy8gICAgIGxvZzogdHJ1ZVxuLy8gICB9XG4vLyB9KTtcblxuLy8gY29uc29sZS5sb2coJy0tLS0tIE5ldXJhbCBOZXR3b3JrIC0tLS0tJyk7XG4vLyBjb25zb2xlLmxvZyhuKTtcblxuLy8gbGV0IGRhdGE6IElUcmFpbmluZ0RhdGEgPSBbXG4vLyAgIHtcbi8vICAgICBpbnB1dDogWzMuMCAvIDEwLjAsIDUuMCAvIDEwLjBdLFxuLy8gICAgIG91dHB1dDogWzc1LjAgLyAxMDAuMF1cbi8vICAgfSxcbi8vICAge1xuLy8gICAgIGlucHV0OiBbNS4wIC8gMTAuMCwgMS4wIC8gMTAuMF0sXG4vLyAgICAgb3V0cHV0OiBbODIuMCAvIDEwMC4wXVxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgaW5wdXQ6IFsxMC4wIC8gMTAuMCwgMi4wIC8gMTAuMF0sXG4vLyAgICAgb3V0cHV0OiBbOTMuMCAvIDEwMC4wXVxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgaW5wdXQ6IFs2LjAgLyAxMC4wLCAzLjAgLyAxMC4wXSxcbi8vICAgICBvdXRwdXQ6IFs4MS4wIC8gMTAwLjBdXG4vLyAgIH1cbi8vIF07XG5cbi8vIGxldCBncmFkaWVudHMgPSBuLmdldEdyYWRpZW50cyhkYXRhKSxcbi8vICAgICBudW1HcmFkaWVudHMgPSBjb21wdXRlTnVtZXJpY2FsR3JhZGllbnRzKG4sIGRhdGEpO1xuXG4vLyAvL2JpYXNlcyBuZXVyb25zIHJlZ3VsYXRpb25cbi8vIG51bUdyYWRpZW50cy5mb3JFYWNoKCh4LCBpKSA9PiB7XG4vLyAgIGlmICh4ID09PSAwKSB7XG4vLyAgICAgbnVtR3JhZGllbnRzW2ldID0gZ3JhZGllbnRzW2ldO1xuLy8gICB9XG4vLyB9KTtcblxuLy8gbGV0IG5vcm1SZXN1bHQgPSByb290TWVhblNxdWFyZShzdWIoZ3JhZGllbnRzLCBudW1HcmFkaWVudHMpKSAvIHJvb3RNZWFuU3F1YXJlKGFkZChncmFkaWVudHMsIG51bUdyYWRpZW50cykpO1xuXG4vLyBjb25zb2xlLmxvZygnLS0tLS0gR3JhZGllbnQgY29tcGFyYWlzb24gLS0tLS0nKTtcbi8vIGNvbnNvbGUuaW5mbyhub3JtUmVzdWx0KTtcblxuXG4vLyBjb25zb2xlLmluZm8oJy0tLS0tIFBSRSBUUkFJTklORyAtLS0tLScpO1xuLy8gY29uc29sZS5sb2cobi5mb3J3YXJkKGRhdGEpKTtcbi8vIGNvbnNvbGUubG9nKG4uY29zdChkYXRhKSk7XG5cbi8vIGxldCB0aW1lID0gK25ldyBEYXRlKCk7XG5cbi8vIG4udHJhaW4oZGF0YSk7XG5cbi8vIGNvbnNvbGUubG9nKCtuZXcgRGF0ZSgpIC0gdGltZSwgJ21zJyk7XG5cbi8vIGNvbnNvbGUuaW5mbygnLS0tLS0gUE9TVCBUUkFJTklORyAtLS0tLScpO1xuLy8gY29uc29sZS5sb2cobi5mb3J3YXJkKGRhdGEpKTtcbi8vIGNvbnNvbGUubG9nKG4uY29zdChkYXRhKSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=