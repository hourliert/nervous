/// <reference path="./all.d.ts" />
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var neuron_1 = require('./neuron');
var synapse_1 = require('./synapse');
var Layer = (function () {
    function Layer(size) {
        this.id = "l_" + Layer.currentId++;
        this.neurons = [];
    }
    Object.defineProperty(Layer.prototype, "neuronsValue", {
        get: function () {
            var ret = [];
            this.forEachNeuron(function (n) { return ret.push(n.A); });
            return ret;
        },
        set: function (values) {
            var hasBiasNeuron = (this.neurons[this.neurons.length - 1] instanceof neuron_1.BiasNeuron) ? 1 : 0;
            if (values.length !== (this.neurons.length - hasBiasNeuron)) {
                throw new Error("The size of the input " + values.length + " differs fron the number of neurons " + (this.neurons.length - hasBiasNeuron));
            }
            this.forEachNeuron(function (n, index) { return n.A = values[index]; });
        },
        enumerable: true,
        configurable: true
    });
    Layer.prototype.linkTo = function (layer) {
        var synapses = [];
        for (var i = 0; i < this.neurons.length; i++) {
            var n1 = this.neurons[i];
            for (var j = 0; j < layer.neurons.length; j++) {
                var n2 = layer.neurons[j], s = new synapse_1.Synapse(n1, n2, Math.random() / Math.sqrt(this.neurons.length));
                n1.addOutputSynapse(s);
                n2.addInputSynapse(s);
                synapses.push(s);
            }
        }
        return synapses;
    };
    Layer.prototype.forEachNeuron = function (func) {
        for (var i = 0; i < this.neurons.length; i++) {
            func(this.neurons[i], i);
        }
    };
    Layer.prototype.activate = function (activationFunctions) {
        this.forEachNeuron(function (n) { return n.activate(activationFunctions); });
    };
    Layer.prototype.computeErrors = function (costStrategy) {
        this.forEachNeuron(function (n) { return n.computeError(costStrategy); });
    };
    Layer.prototype.computeDeltas = function () {
        this.forEachNeuron(function (n) { return n.backPropagate(); });
    };
    Layer.currentId = 0;
    return Layer;
})();
exports.Layer = Layer;
var InputLayer = (function (_super) {
    __extends(InputLayer, _super);
    function InputLayer(size) {
        _super.call(this, size);
        for (var i = 0; i < size; i++) {
            this.neurons.push(new neuron_1.InputNeuron(this, i));
        }
        this.neurons.push(new neuron_1.BiasNeuron(this, size));
    }
    InputLayer.prototype.activate = function () {
        throw new Error("The input layer could not propagate using a previous layer");
    };
    return InputLayer;
})(Layer);
exports.InputLayer = InputLayer;
var HiddenLayer = (function (_super) {
    __extends(HiddenLayer, _super);
    function HiddenLayer(size) {
        _super.call(this, size);
        for (var i = 0; i < size; i++) {
            this.neurons.push(new neuron_1.HiddenNeuron(this, i));
        }
        this.neurons.push(new neuron_1.BiasNeuron(this, size));
    }
    return HiddenLayer;
})(Layer);
exports.HiddenLayer = HiddenLayer;
var OutputLayer = (function (_super) {
    __extends(OutputLayer, _super);
    function OutputLayer(size) {
        _super.call(this, size);
        for (var i = 0; i < size; i++) {
            this.neurons.push(new neuron_1.OutputNeuron(this, i));
        }
    }
    return OutputLayer;
})(Layer);
exports.OutputLayer = OutputLayer;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxheWVyLnRzIl0sIm5hbWVzIjpbIkxheWVyIiwiTGF5ZXIuY29uc3RydWN0b3IiLCJMYXllci5uZXVyb25zVmFsdWUiLCJMYXllci5saW5rVG8iLCJMYXllci5mb3JFYWNoTmV1cm9uIiwiTGF5ZXIuYWN0aXZhdGUiLCJMYXllci5jb21wdXRlRXJyb3JzIiwiTGF5ZXIuY29tcHV0ZURlbHRhcyIsIklucHV0TGF5ZXIiLCJJbnB1dExheWVyLmNvbnN0cnVjdG9yIiwiSW5wdXRMYXllci5hY3RpdmF0ZSIsIkhpZGRlbkxheWVyIiwiSGlkZGVuTGF5ZXIuY29uc3RydWN0b3IiLCJPdXRwdXRMYXllciIsIk91dHB1dExheWVyLmNvbnN0cnVjdG9yIl0sIm1hcHBpbmdzIjoiQUFBQSxtQ0FBbUM7Ozs7Ozs7QUFFbkMsdUJBQTBFLFVBQVUsQ0FBQyxDQUFBO0FBQ3JGLHdCQUFzQyxXQUFXLENBQUMsQ0FBQTtBQUtsRDtJQU9FQSxlQUNFQSxJQUFZQTtRQUdaQyxJQUFJQSxDQUFDQSxFQUFFQSxHQUFHQSxPQUFLQSxLQUFLQSxDQUFDQSxTQUFTQSxFQUFJQSxDQUFDQTtRQUNuQ0EsSUFBSUEsQ0FBQ0EsT0FBT0EsR0FBR0EsRUFBRUEsQ0FBQ0E7SUFFcEJBLENBQUNBO0lBRURELHNCQUFJQSwrQkFBWUE7YUFBaEJBO1lBRUVFLElBQUlBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBO1lBQ2JBLElBQUlBLENBQUNBLGFBQWFBLENBQUNBLFVBQUNBLENBQUNBLElBQUtBLE9BQUFBLEdBQUdBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLEVBQWJBLENBQWFBLENBQUNBLENBQUNBO1lBQ3pDQSxNQUFNQSxDQUFDQSxHQUFHQSxDQUFDQTtRQUViQSxDQUFDQTthQUNERixVQUFrQkEsTUFBZ0JBO1lBRWhDRSxJQUFJQSxhQUFhQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxJQUFJQSxDQUFDQSxPQUFPQSxDQUFDQSxNQUFN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dCI6WyIvLy8gPHJlZmVyZW5jZSBwYXRoPVwiLi9hbGwuZC50c1wiIC8+XG5cbmltcG9ydCB7TmV1cm9uLCBCaWFzTmV1cm9uLCBJbnB1dE5ldXJvbiwgSGlkZGVuTmV1cm9uLCBPdXRwdXROZXVyb259IGZyb20gJy4vbmV1cm9uJztcbmltcG9ydCB7U3luYXBzZSwgSVN5bmFwc2VzTGF5ZXJ9IGZyb20gJy4vc3luYXBzZSc7XG5pbXBvcnQge0lBY3RpdmF0aW9uRnVuY3Rpb25zfSBmcm9tICcuL25ldXJhbC1uZXR3b3JrJztcbmltcG9ydCB7Q29zdFN0cmF0ZWd5fSBmcm9tICcuL2Nvc3QnO1xuXG5cbmV4cG9ydCBjbGFzcyBMYXllciB7XG4gIFxuICBzdGF0aWMgY3VycmVudElkOiBudW1iZXIgPSAwO1xuICBcbiAgcHVibGljIGlkOiBzdHJpbmc7XG4gIHByb3RlY3RlZCBuZXVyb25zOiBOZXVyb25bXTtcbiAgXG4gIGNvbnN0cnVjdG9yIChcbiAgICBzaXplOiBudW1iZXJcbiAgKSB7XG4gICAgXG4gICAgdGhpcy5pZCA9IGBsXyR7TGF5ZXIuY3VycmVudElkKyt9YDtcbiAgICB0aGlzLm5ldXJvbnMgPSBbXTtcbiAgICAgIFxuICB9XG4gIFxuICBnZXQgbmV1cm9uc1ZhbHVlICgpOiBudW1iZXJbXSB7XG4gICAgXG4gICAgbGV0IHJldCA9IFtdO1xuICAgIHRoaXMuZm9yRWFjaE5ldXJvbigobikgPT4gcmV0LnB1c2gobi5BKSk7XG4gICAgcmV0dXJuIHJldDtcbiAgICBcbiAgfVxuICBzZXQgbmV1cm9uc1ZhbHVlICh2YWx1ZXM6IG51bWJlcltdKSB7XG4gICAgXG4gICAgbGV0IGhhc0JpYXNOZXVyb24gPSAodGhpcy5uZXVyb25zW3RoaXMubmV1cm9ucy5sZW5ndGggLTFdIGluc3RhbmNlb2YgQmlhc05ldXJvbikgPyAxIDogMDtcbiAgICBpZiAodmFsdWVzLmxlbmd0aCAhPT0gKHRoaXMubmV1cm9ucy5sZW5ndGggLSBoYXNCaWFzTmV1cm9uKSkgeyAvL3dpdGhvdXQgdGhlIGJpYXNcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHNpemUgb2YgdGhlIGlucHV0ICR7dmFsdWVzLmxlbmd0aH0gZGlmZmVycyBmcm9uIHRoZSBudW1iZXIgb2YgbmV1cm9ucyAke3RoaXMubmV1cm9ucy5sZW5ndGggLSBoYXNCaWFzTmV1cm9ufWApO1xuICAgIH1cbiAgICB0aGlzLmZvckVhY2hOZXVyb24oKG4sIGluZGV4KSA9PiBuLkEgPSB2YWx1ZXNbaW5kZXhdKTtcbiAgICBcbiAgfVxuICBcbiAgcHVibGljIGxpbmtUbyAobGF5ZXI6IExheWVyKTogSVN5bmFwc2VzTGF5ZXIge1xuICAgIFxuICAgIGxldCBzeW5hcHNlcyA9IFtdO1xuICAgIFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5uZXVyb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICBcbiAgICAgIGxldCBuMSA9IHRoaXMubmV1cm9uc1tpXTsgXG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IGxheWVyLm5ldXJvbnMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgXG4gICAgICAgIGxldCBuMiA9IGxheWVyLm5ldXJvbnNbal0sXG4gICAgICAgICAgICBzID0gbmV3IFN5bmFwc2UobjEsIG4yLCBNYXRoLnJhbmRvbSgpIC8gTWF0aC5zcXJ0KHRoaXMubmV1cm9ucy5sZW5ndGgpKTtcbiAgICAgICAgXG4gICAgICAgIG4xLmFkZE91dHB1dFN5bmFwc2Uocyk7XG4gICAgICAgIG4yLmFkZElucHV0U3luYXBzZShzKTtcbiAgICAgICAgc3luYXBzZXMucHVzaChzKTtcbiAgICAgICAgXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBzeW5hcHNlcztcbiAgICBcbiAgfVxuICBcbiAgcHVibGljIGZvckVhY2hOZXVyb24gKGZ1bmM6ICh4OiBOZXVyb24sIGluZGV4PzogbnVtYmVyKSA9PiB2b2lkKSB7XG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDAgOyBpIDwgdGhpcy5uZXVyb25zLmxlbmd0aCA7IGkrKykge1xuICAgICAgZnVuYyh0aGlzLm5ldXJvbnNbaV0sIGkpO1xuICAgIH1cbiAgICBcbiAgfVxuICBcbiAgcHVibGljIGFjdGl2YXRlIChhY3RpdmF0aW9uRnVuY3Rpb25zOiBJQWN0aXZhdGlvbkZ1bmN0aW9ucykge1xuICAgIFxuICAgIHRoaXMuZm9yRWFjaE5ldXJvbigobikgPT4gbi5hY3RpdmF0ZShhY3RpdmF0aW9uRnVuY3Rpb25zKSk7XG4gICAgXG4gIH1cbiAgXG4gIHB1YmxpYyBjb21wdXRlRXJyb3JzIChjb3N0U3RyYXRlZ3k6IENvc3RTdHJhdGVneSkge1xuICAgIFxuICAgIHRoaXMuZm9yRWFjaE5ldXJvbigobikgPT4gbi5jb21wdXRlRXJyb3IoY29zdFN0cmF0ZWd5KSk7XG4gICAgXG4gIH1cbiAgXG4gIHB1YmxpYyBjb21wdXRlRGVsdGFzICgpIHtcbiAgICBcbiAgICB0aGlzLmZvckVhY2hOZXVyb24oKG4pID0+IG4uYmFja1Byb3BhZ2F0ZSgpKTtcbiAgICBcbiAgfVxuICBcbn1cblxuZXhwb3J0IGNsYXNzIElucHV0TGF5ZXIgZXh0ZW5kcyBMYXllciB7XG4gIFxuICBjb25zdHJ1Y3RvciAoXG4gICAgc2l6ZTogbnVtYmVyXG4gICkge1xuICAgIFxuICAgIHN1cGVyKHNpemUpOyAgICBcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgdGhpcy5uZXVyb25zLnB1c2gobmV3IElucHV0TmV1cm9uKHRoaXMsIGkpKTsgICAgXG4gICAgfSBcbiAgICBcbiAgICB0aGlzLm5ldXJvbnMucHVzaChuZXcgQmlhc05ldXJvbih0aGlzLCBzaXplKSk7XG4gICAgXG4gIH1cbiAgXG4gIHB1YmxpYyBhY3RpdmF0ZSAoKSB7XG4gICAgXG4gICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgaW5wdXQgbGF5ZXIgY291bGQgbm90IHByb3BhZ2F0ZSB1c2luZyBhIHByZXZpb3VzIGxheWVyYCk7XG4gICAgXG4gIH1cbiAgXG59XG5cblxuZXhwb3J0IGNsYXNzIEhpZGRlbkxheWVyIGV4dGVuZHMgTGF5ZXIge1xuICBcbiAgY29uc3RydWN0b3IgKFxuICAgIHNpemU6IG51bWJlclxuICApIHtcbiAgICBcbiAgICBzdXBlcihzaXplKTsgXG4gICAgXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgIHRoaXMubmV1cm9ucy5wdXNoKG5ldyBIaWRkZW5OZXVyb24odGhpcywgaSkpOyAgICBcbiAgICB9IFxuICAgICAgIFxuICAgIHRoaXMubmV1cm9ucy5wdXNoKG5ldyBCaWFzTmV1cm9uKHRoaXMsIHNpemUpKTtcbiAgICBcbiAgfVxuICBcbn1cblxuZXhwb3J0IGNsYXNzIE91dHB1dExheWVyIGV4dGVuZHMgTGF5ZXIge1xuICBcbiAgY29uc3RydWN0b3IgKFxuICAgIHNpemU6IG51bWJlclxuICApIHtcbiAgICBcbiAgICBzdXBlcihzaXplKTtcbiAgICBcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgdGhpcy5uZXVyb25zLnB1c2gobmV3IE91dHB1dE5ldXJvbih0aGlzLCBpKSk7ICAgIFxuICAgIH0gXG4gICAgICAgIFxuICB9XG4gIFxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==